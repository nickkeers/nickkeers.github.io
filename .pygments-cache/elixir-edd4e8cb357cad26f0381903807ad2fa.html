<div class="highlight"><pre><span class="kd">defmodule</span> <span class="nc">FileScan</span> <span class="k">do</span>

  <span class="kd">def</span> <span class="n">process</span><span class="p">(</span><span class="n">what</span><span class="p">)</span> <span class="k">do</span>
    <span class="nc">IO</span><span class="p">.</span><span class="n">puts</span> <span class="s2">&quot;File sizes in current directory&quot;</span>
    <span class="k">for</span> <span class="n">file</span> <span class="p">&lt;-</span> <span class="n">what</span> <span class="k">do</span>
      <span class="nc">IO</span><span class="p">.</span><span class="n">puts</span> <span class="s2">&quot;-------------------&quot;</span>
      <span class="nc">IO</span><span class="p">.</span><span class="n">puts</span> <span class="s2">&quot;File: &quot;</span> <span class="o">&lt;&gt;</span> <span class="n">file</span>
      <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span> <span class="n">f</span><span class="p">}</span> <span class="p">=</span> <span class="ss">:file</span><span class="p">.</span><span class="n">read_file_info</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
      <span class="n">details</span> <span class="p">=</span> <span class="nc">File.Stat</span><span class="p">.</span><span class="n">from_record</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
      <span class="nc">IO</span><span class="p">.</span><span class="n">puts</span> <span class="s2">&quot;File size: &quot;</span> <span class="o">&lt;&gt;</span> <span class="p">(</span><span class="n">to_string</span> <span class="n">details</span><span class="p">.</span><span class="n">size</span> <span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="s2">&quot; bytes&quot;</span>
    <span class="k">end</span>
    <span class="nc">IO</span><span class="p">.</span><span class="n">puts</span> <span class="s2">&quot;-------------------&quot;</span>
  <span class="k">end</span>

<span class="k">end</span>
<span class="k">try</span> <span class="k">do</span>
  <span class="nc">File</span><span class="p">.</span><span class="n">ls!</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">|&gt;</span> <span class="nc">Enum</span><span class="p">.</span><span class="n">filter</span><span class="p">(</span><span class="k">fn</span> <span class="n">f</span> <span class="p">-&gt;</span> <span class="ow">not</span> <span class="nc">File</span><span class="p">.</span><span class="n">dir?</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">end</span><span class="p">)</span>
  <span class="o">|&gt;</span> <span class="nc">FileScan</span><span class="p">.</span><span class="n">process</span><span class="p">()</span>
<span class="k">rescue</span>
  <span class="nc">File.Error</span> <span class="p">-&gt;</span> <span class="s2">&quot;Rescued file error&quot;</span>
  <span class="n">_error</span>     <span class="p">-&gt;</span> <span class="s2">&quot;Rescued unknown error&quot;</span>
<span class="k">end</span>
</pre></div>